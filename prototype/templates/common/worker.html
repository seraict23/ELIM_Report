{%extends 'common/base.html'%} {% block CSS %}
<style>
  .main-body-container {
    width: 800px;
    height: 100%;
    margin-right: 300px;
  }
  .main-body-box {
    border: solid 1px grey;
    background-color: rgba(240, 249, 254, 1);
    margin-bottom: 20px;
  }
  .input-in-grid {
    display: block;
    width: 100%;
    border: none;
    margin: 0;
    border:dotted 1px grey;
  }
</style>

{% endblock %} {% block BODY %}

<div class="main-body-container">
  <div class="main-body-box">
    <div
      style="margin: 30px; display: flex; flex-direction: column"
    >
      <div class="container text-center" style="border: solid 1px grey">
        <div class="row">
          <div class="col">구분</div>
          <div class="col">성명</div>
          <div class="col">자격</div>
          <div class="col">참여기간</div>
          <div class="col">참여현황</div>
          <div class="col">비고</div>
        </div>
        {% comment %} 입력 {% endcomment %}
        <div class="row">
            <div class="col" style="padding:0px">
                <input class="input-in-grid" type="text" name="1-1">
            </div>
            <div class="col" style="padding:0px">
                <input class="input-in-grid" type="text" name="1-2">
            </div>
            <div class="col" style="padding:0px">
                <input class="input-in-grid" type="text" name="1-3">
            </div>
            <div class="col" style="padding:0px">
                <input class="input-in-grid" type="text" name="1-4" value="{{report_date}}">
            </div>
            <div class="col" style="padding:0px">
                <input class="input-in-grid" type="text" name="1-5">
            </div>
            <div class="col" style="padding:0px">
                <input class="input-in-grid" type="text" name="1-6">
            </div>
        </div>
        <div id="worker-appendrow">
        </div>
          <span id="worker-appendrow-button" class="material-symbols-outlined">
            add
          </span>

      {% comment %} 사진추가 {% endcomment %} 
      </div>
    </div>
    <div style="margin:30px">
        <button id="temporary" type="button" class="btn btn-primary btn-lg">저장하기</button>
        <button type="button" class="btn btn-secondary btn-lg">생성하기</button>
    </div>
  </div>
</div>

<script
  src="https://code.jquery.com/jquery-3.6.4.js"
  integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E="
  crossorigin="anonymous"
></script>

<script>
  $.ajaxSetup({
    headers: { "X-CSRFToken": '{{csrf_token}}' }
  });
</script>

<script>
    let row=1;
    $("#worker-appendrow-button").on("click", () => {
      row++;
      $("#worker-appendrow").append('<div class="row">'+
          '<div class="col" style="padding:0px"><input class="input-in-grid" type="text" name="'+row.toString()+'-1"></div>'+
          '<div class="col" style="padding:0px"><input class="input-in-grid" type="text" name="'+row.toString()+'-2"></div>'+
          '<div class="col" style="padding:0px"><input class="input-in-grid" type="text" name="'+row.toString()+'-3"></div>'+
          '<div class="col" style="padding:0px"><input class="input-in-grid" type="text" name="'+row.toString()+'-4" value="{{report_date}}"></div>'+
          '<div class="col" style="padding:0px"><input class="input-in-grid" type="text" name="'+row.toString()+'-5"></div>'+
          '<div class="col" style="padding:0px"><input class="input-in-grid" type="text" name="'+row.toString()+'-6"></div>'+
          '</div>'
      );

    });


    $("#temporary").on("click", () => {
        let fd = new FormData();
        fd.append("worker-length", row.toString())
        for(let i = 1; i <= row; i++) {
          for(let j = 1; j<=6; j++)
            fd.append("worker-"+i.toString(), $("input[name="+i.toString()+"-"+j.toString()+"]").val())
        }

        $.ajax({
            url: "/worker/",
            data: fd,
            method: "POST", 
            processData: false,
            contentType: false,
            success: () => {
              console.log("성공");
            },
            error: (req, status, err) => {
              console.log(err);
            },
            complete: () => {
              console.log("완료");
            },
        })
    })


</script>

{% endblock %}
